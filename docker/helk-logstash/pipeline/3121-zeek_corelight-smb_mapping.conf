# HELK Zeek and Corelight SMB_Mapping log
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {
  if [event_log_type] == "zeek" and [event_log_sub_type] == "smb_mapping" {

    mutate {
      rename => {
        "file_system_type" => "native_file_system"
        "path" => "share_name"
        "service" => "smb_service"
        "share_type" => "smb_share_type"
      }
      add_field => { "etl_pipeline" => "zeek-smb_mapping-main" }
    }

  }
}