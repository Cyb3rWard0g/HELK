# HELK Zeek and Corelight Files log
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0
  
filter {
  if [event_log_type] == "zeek" and [event_log_sub_type] == "files" {

    mutate {
      rename => {
        "analyzers" => "zeek_files_analyzers"
        "depth" => "files_depth"
        "duration" => "files_duration"
        "entropy" => "zeek_files_entropy"
        "extracted" => "zeek_files_extracted"
        "extracted_cutoff" => "zeek_files_extracted_cutoff"
        "extracted_size" => "zeek_files_extracted_size"
        "filename" => "file_name"
        "is_orig" => "files_is_orig"
        "local_orig" => "files_local_orig"
        "md5" => "hash_md5"
        "mime_type" => "file_mime_type"
        "missing_bytes" => "zeek_files_missing_bytes"
        "overflow_bytes" => "zeek_files_overflow_bytes"
        "rx_hosts" => "src_ip_addr"
        "seen_bytes" => "zeek_files_seen_bytes"
        "sha1" => "hash_sha1"
        "sha256" => "hash_sha256"
        "source" => "files_soure"
        "timedout" => "zeek_files_timedout"
        "total_bytes" => "file_size"
        "tx_hosts" => "dst_ip_addr"
        "x509" => "files_x509"
      }
      replace => { "event_uid" => "%{zeek_id_fuid}" }
      add_field => { "etl_pipeline" => "zeek-files-main" }
    }

  }
}