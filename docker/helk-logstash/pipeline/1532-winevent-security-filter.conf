# HELK winevent-security filter conf file
# HELK build Stage: Alpha
# Author: Roberto Rodriguez (@Cyb3rWard0g)
# License: GPL-3.0

filter {
  if [log_name] =~ /^[sS]ecurity$/ {
    mutate {
      add_field => {
        "etl_pipeline" => "winevent-security-all-1532"
        "[@metadata][index_name]" => "security"
      }
    }
    if [event_id] == 4610 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4610.md
      mutate {
        rename => {
          "AuthenticationPackageName" => "logon_authentication_package_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4610-ossem" }
      }
    }
    if [event_id] == 4611 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4611.md
      mutate {
        rename => {
          "SubjectUserSid" => "user_sid"
          "SubjectUserName" => "user_name"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "LogonProcessName" => "logon_process_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4610-ossem" }
      }
    }
    if [event_id] == 4614 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4614.md
      mutate {
        rename => {
          "NotificationPackageName" => "logon_notification_package_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4614-ossem" }
      }
    }
    if [event_id] == 4616 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4616.md
      mutate {
        rename => {
          "NewTime" => "@date_new_time"
          "PreviousTime" => "@date_previous_time"
          "SubjectUserSid" => "user_sid"
          "SubjectUserName" => "user_name"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
        }
      }
    }
    if [event_id] == 4622 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4622.md
      mutate {
        rename => {
          "SecurityPackageName" => "logon_security_package_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4622-ossem" }
      }
    }
    if [event_id] == 4624 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4624.md
      mutate {
        rename => {
          "SubjectUserSid" => "user_reporter_sid"
          "SubjectUserName" => "user_reporter_name"
          "SubjectDomainName" => "user_reporter_domain"
          "SubjectLogonId" => "reporter_logon_id"
          "TargetLogonId" => "user_logon_id"
          "RestrictedAdminMode" => "logon_restricted_adminmode"
          "VirtualAccount" => "logon_virtual_account"
          "ElevatedToken" => "logon_elevated_token"
          "TargetUserName" => "user_name"
          "TargetDomainName" => "user_domain"
          "TargetLinkedLogonId" => "user_linked_logon_id"
          "TargetOutboundDomainName" => "user_network_account_domain"
          "TargetOutboundUserName" => "user_network_account_name"
          "TargetUserSid" => "user_sid"
          "ImpersonationLevel" => "impersonation_level"
          "LogonGuid" => "user_logon_guid"
          "WorkstationName" => "src_host_name"
          "IpPort" => "src_port"
          "LogonProcessName" => "logon_process_name"
          "AuthenticationPackageName" => "logon_authentication_package_name"
          "TransmittedServices" => "logon_transmitted_services"
          "LmPackageName" => "logon_package_name"
          "KeyLength" => "logon_key_length"
          "ProcessName" => "process_path"
        }
      }
      if "logon_elevated_token" == "Yes"{
        mutate { add_tag => ["elevated_logon"] }
      }
    }
    if [event_id] == 4625 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4625.md
      mutate {
        rename => {
          "SubjectUserSid" => "user_reporter_sid"
          "SubjectUserName" => "user_reporter_name"
          "SubjectDomainName" => "user_reporter_domain"
          "SubjectLogonId" => "reporter_logon_id"
          "TargetUserName" => "user_name"
          "TargetDomainName" => "user_domain"
          "TargetUserSid" => "user_sid"
          "WorkstationName" => "src_host_name"
          "IpPort" => "src_port"
          "LogonProcessName" => "logon_process_name"
          "AuthenticationPackageName" => "logon_authentication_package_name"
          "TransmittedServices" => "logon_transmitted_services"
          "LmPackageName" => "logon_package_name"
          "KeyLength" => "logon_key_length"
          "FailureReason" => "logon_failure_reason"
          "Status" => "event_status"
          "SubStatus" => "event_sub_status"
          "ProcessName" => "process_path"
        }
      }
      if "logon_elevated_token" == "Yes"{
        mutate { add_tag => ["elevated_logon"] }
      }
    }
    if [event_id] == 4627 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4627.md
      mutate {
        rename => {
          "SubjectUserSid" => "user_reporter_sid"
          "SubjectUserName" => "user_reporter_name"
          "SubjectDomainName" => "user_reporter_domain"
          "SubjectLogonId" => "reporter_logon_id"
          "TargetLogonId" => "user_logon_id"
          "TargetUserName" => "user_name"
          "TargetDomainName" => "user_domain"
          "TargetUserSid" => "user_sid"
          "GroupMembership" => "user_group_membership"
        }
        remove_field => [
          "EventCountTotal",
          "EventIdx"
        ]
      }
    }
    if [event_id] == 4634 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4634.md
      mutate {
        rename => {
          "TargetDomainName" => "user_domain"
          "TargetLogonId" => "user_logon_id"
          "TargetUserName" => "user_name"
          "TargetUserSid" => "user_sid"
        }
      }
    }
    if [event_id] == 4647 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4647.md
      mutate {
        rename => {
          "TargetDomainName" => "user_domain"
          "TargetLogonId" => "user_logon_id"
          "TargetUserName" => "user_name"
          "TargetUserSid" => "user_sid"
        }
      }
    }
    if [event_id] == 4648 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4648.md
      mutate {
        rename => {
          "SubjectUserSid" => "user_sid"
          "SubjectUserName" => "user_name"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "LogonGuid" => "user_logon_guid"
          "TargetUserName" => "target_user_name"
          "TargetDomainName" => "target_user_domain"
          "TargetLogonId" => "target_user_logon_id"
          "TargetServerName" => "target_server_name"
          "TargetInfo" => "service_host_info"
          "TargetLogonGuid" => "target_user_logon_guid"
          "IpPort" => "src_port"
          "ProcessName" => "process_path"
        }
        copy => {
          "target_server_name" => "service_host_name"
        }
      }
    }
    if [event_id] == 4649 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4649.md
      mutate {
        rename => {
          "AuthenticationPackageName" => "logon_authentication_package_name"
          "LogonProcessName" => "logon_process_name"
          "ProcessId" => "process_id"
          "ProcessName" => "process_path"
          "RequestType" => "ticket_request_type"
          "SubjectDomainName" => "user_reporter_domain"
          "SubjectLogonId" => "user_reporter_logon_id"
          "SubjectUserSid" => "user_reporter_sid"
          "SubjectUserName" => "user_reporter_name"
          "TargetDomainName" => "user_domain"
          "TargetUserName" => "user_name"
          "TransmittedServices" => "logon_transmitted_services"
          "WorkstationName" => "src_host_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4649-ossem" }
      }
    }
    if [event_id] == 4656 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4656.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "AccessList" => "object_access_list"
          "AccessMask" => "object_access_mask"
          "AccessReason" => "object_access_reason"
          "ObjectName" => "object_name"
          "ObjectServer" => "object_server"
          "ObjectType" => "object_type"
          "HandleId" => "object_handle_id"
          "PrivilegeList" => "object_privilege_list"
          "TransactionId" => "transaction_guid"
          "ResourceAttributes" => "object_resource_attributes"
          "RestrictedSidCount" => "object_restricted_sid_count"
          "ProcessName" => "process_path"
        }
      }
    }
    if [event_id] == 4657 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4657.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "ObjectName" => "registry_key_path"
          "ObjectValueName" => "registry_key_value_name"
          "HandleId" => "object_handle_id"
          "OperationType" => "object_operation_type"
          "OldValueType" => "object_value_old_type"
          "OldValue" => "registry_value_old_data"
          "NewValueType" => "registry_key_value_type"
          "NewValue" => "registry_key_value_data"
          "ProcessName" => "process_path"
        }
        copy => {
          "registry_key_path" => "object_name"
          "registry_key_value_data" => "object_value_new"
          "registry_key_value_name" => "object_value_name"
          "registry_key_value_type" => "object_value_new_type"
          "registry_value_old_data" => "object_value_old"
          "ticket_status" => "event_status"
        }
        add_field => { "etl_pipeline" => "winevent_security-4657-ossem" }
      }
    }
    if [event_id] == 4658 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4658.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "ObjectServer" => "object_server"
          "HandleId" => "object_handle_id"
        }
      }
    }
    if [event_id] == 4659 {
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "ObjectName" => "object_name"
          "ObjectServer" => "object_server"
          "ObjectType" => "object_type"
          "HandleId" => "object_handle_id"
          "TransactionId" => "transaction_guid"
          "AccessList" => "object_access_list"
          "AccessMask" => "object_access_mask"
          "ProcessName" => "process_path"
        }
      }
    }
    if [event_id] in [ 4660, 4661, 4662, 4663 ] {
      # https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4660
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4661.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4662.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4663.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "Properties" => "object_properties"
          "AccessMask" => "object_access_mask"
          "HandleId" => "object_handle_id"
          "ObjectName" => "object_name"
          "ObjectServer" => "object_server"
          "ObjectType" => "object_type"
          "AdditionalInfo2" => "object_additional_info2"
          "OperationType" => "object_operation_type"
          "AdditionalInfo" => "object_additional_info"
          "AccessList" => "object_access_list"
          "ResourceAttributes" => "object_resource_attributes"
          "PrivilegeList" => "object_privilege_list"
          "TransactionId" => "transaction_guid"
          "RestrictedSidCount" => "object_restricted_sid_count"
          "ProcessName" => "process_path"
        }
      }
    }
    if [event_id] == 4670 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4670.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "HandleId" => "object_handle_id"
          "NewSd" => "object_new_sd"
          "ObjectName" => "object_name"
          "ObjectServer" => "object_server"
          "ObjectType" => "object_type"
          "OldSd" => "object_old_sd"
          "ProcessName" => "process_path"
        }
      }
    }
    if [event_id] == 4672 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4672.md
      mutate {
        rename => {
          "PrivilegeList" => "logon_privilege_list"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
        }
      }
    }
    if [event_id] == 4673 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4673.md
      mutate {
        rename => {
          "PrivilegeList" => "service_privilege_list"
          "ObjectServer" => "object_server"
          "Service" => "service_name"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
        }
      }
    }
    if [event_id] == 4674 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4674.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "AccessMask" => "object_access_mask"
          "HandleId" => "object_handle_id"
          "ObjectName" => "object_name"
          "ObjectServer" => "object_server"
          "ObjectType" => "object_type"
          "PrivilegeList" => "object_privilege_list"
        }
      }
    }
    if [event_id] == 4985 {
      # https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4985
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TransactionId" => "transaction_guid"
          "NewState" => "object_transaction_new_state"
          "ResourceManager" => "object_transaction_resource_manager"
          "ProcessName" => "process_path"
        }
      }
    }
    if [event_id] == 4688 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4688.md
      mutate {
        rename => {
          "CommandLine" => "process_command_line"
          "MandatoryLabel" => "process_mandatory_sid"
          "NewProcessId" => "process_id"
          "NewProcessName" => "process_path"
          "ParentProcessName" => "process_parent_path"
          "ProcessId" => "process_parent_id"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_user_domain"
          "TargetUserSid" => "target_user_sid"
          "TargetUserName" => "target_user_name"
          "TargetLogonId" => "target_user_logon_id"
          "TokenElevationType" => "process_token_elevation_type"
        }
      }
    }
    if [event_id] == 4689 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4689.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "Status" => "event_status"
          "ProcessName" => "process_path"
        }
      }
    }
    if [event_id] == 4690 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4690.md
      mutate {
        rename => {
          "ProcessId" => "reporter_process_id"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "SourceHandleId" => "object_handle_id"
          "SourceProcessId" => "process_id"
          "TargetHandleId" => "target_object_handle_id"
          "TargetProcessId" => "target_process_id"
        }
        #TODO: Keep backwards compatibility for now
        copy => {
          "object_handle_id" => "process_handle_id"
          "target_object_handle_id" => "target_process_handle_id"
        }
      }
    }
    if [event_id] == 4696 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4696.md
      mutate {
        rename => {
          "ProcessId" => "process_id"
          "ProcessName" => "process_path"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_user_domain"
          "TargetUserSid" => "target_user_sid"
          "TargetUserName" => "target_user_name"
          "TargetLogonId" => "target_user_logon_id"
          "TargetProcessName" => "target_process_path"
        }
        add_field => { "etl_pipeline" => "winevent_security-4696-ossem" }
      }
    }
    if [event_id] == 4697 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4697.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "ServiceAccount" => "service_account_name"
          "ServiceFileName" => "service_image_path"
          "ServiceName" => "service_name"
          "ServiceStartType" => "service_start_type"
          "ServiceType" => "service_type"
        }
        add_field => { "etl_pipeline" => "winevent_security-4697-ossem" }
      }
    }
    if [event_id] in [ 4698, 4699, 4700, 4701, 4702 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4698.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4709.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4700.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4701.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4702.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TaskName" => "scheduled_task_name"
          "TaskContent" => "scheduled_task_content"
          "TaskContentNew" => "scheduled_task_content"
        }
        add_field => { "etl_pipeline" => "winevent_security-other_object_access_scheduled_tasks-ossem" }
      }
    }
    if [event_id] == 4701 or [event_id] == 4702 {
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TaskName" => "task_name"
        }
      }
    }
    if [event_id] == 4703 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4703.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_user_domain"
          "TargetLogonId" => "target_user_logon_id"
          "TargetUserSid" => "target_user_sid"
          "TargetUserName" => "target_user_name"
          "DisabledPrivilegeList" => "target_user_disabled_privilege_list"
          "EnabledPrivilegeList" => "target_user_enabled_privilege_list"
        }
      }
    }
    if [event_id] == 4704 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4704.md
      mutate {
        rename => {
          "SubjectUserSid" => "user_sid"
          "SubjectUserName" => "user_name"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "TargetSid" => "target_user_sid"
          "PrivilegeList" => "user_privilege_list"
        }
        copy => { "user_privilege_list" => "target_user_privilege_list" }
      }
    }
    if [event_id] in [ 4715, 4719, 4817, 4902, 4904, 4905, 4906, 4907, 4908, 4912 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4715.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4719.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4817.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4902.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4904.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4905.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4906.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4907.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4908.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4912.md
      #TODO: for now no sense of renaming PuaCount and PuaPolicyId because exist in no other event logs
      mutate {
        rename => {
          "AuditPolicyChanges" => "policy_changes"
          "AuditSourceName" => "event_source_name"
          "CategoryId" => "policy_category_id"
          "CrashOnAuditFailValue" => "crash_on_audit_fail_value"
          "EventSourceId" => "event_source_id"
          "HandleId" => "object_handle_id"
          "NewSd" => "object_new_sd"
          "ObjectName" => "object_name"
          "ObjectServer" => "object_server"
          "ObjectType" => "object_type"
          "OldSd" => "object_old_sd"
          "ProcessId" => "process_id"
          "ProcessName" => "process_path"
          "SidList" => "sid_list"
          "SubcategoryGuid" => "policy_subcategory_guid"
          "SubcategoryId" => "policy_subcategory_id"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
        }
        add_field => { "etl_pipeline" => "winevent_security-audit_audit_policy_change-ossem" }
      }
    }
    if [event_id] in [ 4722, 4723, 4724, 4725, 4726 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4722.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4723.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4724.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4725.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4726.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_user_domain"
          "TargetSid" => "target_user_sid"
          "TargetUserName" => "target_user_name"
          "PrivilegeList" => "user_privilege_list"
        }
        add_field => { "etl_pipeline" => "winevent_security-4722_4723_4724_4725_4726-ossem" }
      }
    }
    if [event_id] in [ 4727, 4728, 4729, 4730, 4731, 4732, 4733, 4734, 4735, 4737, 4754, 4755, 4756, 4757, 4758, 4764 ] {
      #TODO:use OSSEM links for this from now on
      mutate {
        rename => {
          "GroupTypeChange" => "group_type_change"
          "MemberName" => "target_user_name"
          "MemberSid" => "target_user_sid"
          "PrivilegeList" => "user_privilege_list"
          "SubjectDomainName" => "user_domain"
          "SamAccountName" => "group_sam_name"
          "SidHistory" => "group_sid_history"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "group_domain"
          "TargetSid" => "group_sid"
          "TargetUserName" => "group_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-audit_security_group_management-ossem" }
      }
    }
    if [event_id] in [ 4744, 4745, 4746, 4747, 4748, 4749, 4750, 4751, 4752, 4753, 4759, 4760, 4761, 4762, 4763 ] {
      #TODO:use OSSEM links for this from now on
      mutate {
        rename => {
          "GroupTypeChange" => "group_type_change"
          "MemberName" => "target_user_name"
          "MemberSid" => "target_user_sid"
          "PrivilegeList" => "user_privilege_list"
          "SubjectDomainName" => "user_domain"
          "SamAccountName" => "group_sam_name"
          "SidHistory" => "group_sid_history"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "group_domain"
          "TargetSid" => "group_sid"
          "TargetUserName" => "group_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-audit_distribution_group_management-ossem" }
      }
    }
    if [event_id] == 4738 or [event_id] == 4720 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4738.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4720.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_user_domain"
          "TargetSid" => "target_user_sid"
          "TargetUserName" => "target_user_name"
          "AccountExpires" => "target_user_account_expires"
          "AllowedToDelegateTo" => "target_user_allowed_to_delegate"
          "DisplayName" => "target_user_display"
          "Dummy" => "user_attribute_dummy"
          "HomeDirectory" => "target_user_home_directory"
          "HomePath" => "target_user_home_path"
          "LogonHours" => "target_user_logon_hours"
          "NewUacValue" => "target_user_new_uac_value"
          "OldUacValue" => "target_user_old_uac_value"
          "PasswordLastSet" => "target_user_account_expires"
          "PrimaryGroupId" => "target_user_primary_group_id"
          "PrivilegeList" => "user_privilege_list"
          "ProfilePath" => "target_user_profile_path"
          "SamAccountName" => "target_user_sam_name"
          "ScriptPath" => "target_user_script_path"
          "SidHistory" => "target_user_sid_history"
          "UserPrincipalName" => "target_user_principal_name"
          "UserAccountControl" => "target_user_account_control"
          "UserParameters" => "target_user_parameters"
          "UserWorkstations" => "target_user_workstations"
          
        }
        add_field => { "etl_pipeline" => "winevent_security-4720_4738-ossem" }
      }
    }
    if [event_id] in [ 4740, 4767 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4740.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4767.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_reporter_domain"
          "SubjectLogonId" => "user_reporter_logon_id"
          "SubjectUserName" => "user_reporter_name"
          "SubjectUserSid" => "user_reporter_sid"
          "TargetDomainName" => "user_domain"
          "TargetSid" => "user_sid"
          "TargetUserName" => "user_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4740_4767-ossem" }
      }
    }
    if [event_id] in [ 4741, 4742, 4743 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4741.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4742.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4743.md
      mutate {
        rename => {
          "AccountExpires" => "target_host_account_expires"
          "AllowedToDelegateTo" => "target_host_allowed_to_delegate"
          "ComputerAccountChange" => "computer_account_change"
          "DisplayName" => "target_host_display_name"
          "DnsHostName" => "target_host_dns_host_name"
          "HomeDirectory" => "target_host_home_directory"
          "HomePath" => "target_host_home_path"
          "LogonHours" => "target_host_logon_hours"
          "NewUacValue" => "target_host_new_uac_value"
          "OldUacValue" => "target_host_old_uac_value"
          "PasswordLastSet" => "target_host_password_last_set"
          "PrimaryGroupId" => "target_host_primary_group_id"
          "PrivilegeList" => "user_privilege_list"
          "ProcessId" => "process_id"
          "ProfilePath" => "target_host_profile_path"
          "SamAccountName" => "target_host_sam_name"
          "ScriptPath" => "target_host_script_path"
          "ServicePrincipalNames" => "target_host_service_principal_names"
          "SidHistory" => "target_host_sid_history"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_host_domain"
          "TargetSid" => "target_host_sid"
          "TargetUserName" => "target_host_name"
          "UserAccountControl" => "target_host_user_account_control"
          "UserParameters" => "target_host_user_paremeters"
          "UserPrincipalName" => "target_host_principal_name"
          "UserWorkstations" => "target_host_workstations"
        }
        add_field => { "etl_pipeline" => "winevent_security-4741_4742_4743-ossem" }
      }
    }
    if [event_id] in [ 4768, 4769, 4770, 4771, 4772, 4773 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4768.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4769.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4771.md
      mutate {
        rename => {
          "TargetDomainName" => "user_domain"
          "TargetUserName" => "user_name"
          "IpPort" => "src_port"
          "PreAuthType" => "service_ticket_preauth_type"
          "LogonGuid" => "user_logon_guid"
          "ServiceName" => "service_ticket_name"
          "ServiceSid" => "service_ticket_id"
          "Status" => "ticket_status"
          "TicketEncryptionType" => "ticket_encryption_type"
          "TicketOptions" => "ticket_options"
          "FailureCode" => "ticket_failure_code"
          "TargetSid" => "user_sid"
        }
        copy => {
          "service_name" => "service_ticket_name"
          "ticket_status" => "event_status"
        }
        add_field => { "etl_pipeline" => "winevent_security-4768_4769_4770_4771_4772_4773-ossem" }
      }
    }
    if [event_id] == 4776 or [event_id] == 4777 {
      # https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4776
      # https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4777
      mutate {
        rename => {
          "PackageName" => "logon_authentication_package_name"
          "TargetUserName" => "user_name"
          "Workstation" => "src_host_name"
          "Status" => "event_status"
        }
      }
    }
    if [event_id] in [ 4778, 4779 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4778.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4779.md
      mutate {
        rename => {
          "AccountName" => "user_name"
          "AccountDomain" => "user_domain"
          "LogonID" => "user_logon_id"
          "SessionName" => "session_name"
          "ClientName" => "src_host_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4778_4779-ossem" }
      }
    }
    if [event_id] == 4781 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4781.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetSid" => "target_user_sid"
          "TargetDomainName" => "target_user_domain"
          "NewTargetUserName" => "target_user_new_name"
          "OldTargetUserName" => "target_user_old_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4781-ossem" }
      }
    }
    if [event_id] in [ 4782, 4793 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4782.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4793.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetUserName" => "target_user_name"
          "Workstation" => "source_host_name"
          "Status" => "event_status"
        }
        add_field => { "etl_pipeline" => "winevent_security-4782_4793-ossem" }
      }
    }
    if [event_id] == 4794 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4794.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "Workstation" => "source_host_name"
          "Status" => "event_status"
        }
        add_field => { "etl_pipeline" => "winevent_security-4794-ossem" }
      }
    }
    if [event_id] == 4797 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4797.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_domain_name"
          "TargetUserName" => "target_user_name"
          "Workstation" => "source_host_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4797-ossem" }
      }
    }
    if [event_id] == 4798 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4798.md
      mutate {
        rename => {
          "CallerProcessId" => "process_id"
          "CallerProcessName" => "process_path"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_user_domain"
          "TargetSid" => "target_user_sid"
          "TargetUserName" => "target_user_name"
        }
        remove_field => [ "ProcessID" ]
        add_field => { "etl_pipeline" => "winevent_security-4798-ossem" }
      }
    }
    if [event_id] == 4799 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4799.md
      mutate {
        rename => {
          "CallerProcessId" => "process_id"
          "CallerProcessName" => "process_path"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "group_domain"
          "TargetSid" => "group_sid"
          "TargetUserName" => "group_name"
        }
        remove_field => [ "ProcessID" ]
        add_field => { "etl_pipeline" => "winevent_security-4799-ossem" }
      }
    }
    if [event_id] in [ 4800, 4801, 4802, 4803 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4800.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4801.md
      mutate {
        rename => {
          "TargetDomainName" => "user_domain"
          "TargetUserSid" => "user_sid"
          "TargetUserName" => "user_name"
          "TargetLogonId" => "user_logon_id"
          "SessionId" => "user_session_id"
        }
        add_field => { "etl_pipeline" => "winevent_security-4800_4801_4802_4803-ossem" }
      }
    }
    if [event_id] == 4825 {
      # https://github.com/hunters-forge/OSSEM/blob/master/data_dictionaries/windows/security/events/event-4825.md
      mutate {
        rename => {
          "AccountDomain" => "user_domain"
          "AccountName" => "user_name"
          "LogonID" => "user_logon_id"
        }
        add_field => { "etl_pipeline" => "winevent_security-4825-ossem" }
      }
    }
    if [event_id] == 4956 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4956.md
      mutate {
        rename => {
          "ActiveProfile" => "firewall_active_profile"
        }
      }
    }
    if [event_id] == 4957 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4957.md
      mutate {
        rename => {
          "RuleAttr" => "firewall_rule_attr"
          "RuleId" => "firewall_rule_id"
          "RuleName" => "firewall_rule_name"
        }
      }
    }
    if [event_id] in [ 5058, 5059, 5061 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5058.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5059.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5061.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "AlgorithmName" => "key_algorithm_name"
          "KeyName" => "key_name"
          "KeyType" => "key_type"
          "Operation" => "key_operation"
          "ProviderName" => "key_provider_name"
          "ReturnCode" => "key_return_code"
          "ClientCreationTime" => "process_creation_time"
          "ClientProcessId" => "process_id"
          "KeyFilePath" => "key_file_path"
        }
      }
    }
    if [event_id] in [5136, 5137, 5138, 5139, 5141, 5169, 5170] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5136.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5137.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5138.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5139.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5141.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "OpCorrelationID" => "dsoperation_correlation_id"
          "AppCorrelationID" => "dsoperation_app_correlation_id"
          "DSName" => "host_domain"
          "DSType" => "dsobject_domain_type"
          "ObjectDN" => "dsobject_dn"
          "ObjectGUID" => "dsobject_guid"
          "ObjectClass" => "dsobject_class"
          "AttributeLDAPDisplayName" => "dsobject_attribute_name"
          "AttributeSyntaxOID" => "dsobject_attribute_type"
          "AttributeValue" => "dsobject_attribute_value"
          "OperationType" => "dsoperation_type"
          "NewObjectDN" => "dsobject_new_dn"
          "OldObjectDN" => "dsobject_old_dn"
        }
        copy => { "host_domain" => "dsobject_domain" }
        #TODO:not renaming TreeDelete for now
        add_field => { "etl_pipeline" => "winevent_security-audit_directory_service_changes-ossem" }
      }
    }
    if [event_id] in [ 5140, 5142, 5143, 5144, 5145 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5140.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5142.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5143.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5144.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5145.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "AccessList" => "user_access_list"
          "AccessMask" => "share_access_mask"
          "AccessReason" => "user_access_reason"
          "IpPort" => "src_port"
          "ObjectType" => "object_type"
          "RelativeTargetName" => "share_relative_target_name"
          "ShareLocalPath" => "share_local_path"
          "ShareName" => "share_name"
          "OldRemark" => "share_old_remark"
          "NewRemark" => "share_new_remark"
          "OldMaxUsers" => "share_old_max_users"
          "NewMaxUsers" => "share_new_max_users"
          "OldShareFlags" => "share_old_flags"
          "NewShareFlags" => "share_new_flags"
          "OldSD" => "share_old_sd"
          "NewSD" => "share_new_sd"
        }
        copy => { "user_access_list" => "object_access_list_requested" }
        copy => { "share_access_mask" => "object_access_mask_requested" }
        copy => { "user_access_reason" => "dsobject_domain" }
      }
    }
    if [event_id] == 5168 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5168.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "SpnName" => "spn_name"
          "ErrorCode" => "error_code"
          "ServerNames" => "server_names"
          "ConfiguredNames" => "configured_names"
          "IpAddresses" => "ip_addresses"
        }
      }
    }

    if [event_id] in [ 5152, 5154, 5156, 5157, 5158 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5152.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5154.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5156.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5157.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5158.md
      mutate {
        rename => {
          "DestPort" => "dst_port"
          "Direction" => "network_direction"
          "FilterRTID" => "network_filter_rtid"
          "LayerName" => "network_layer_name"
          "LayerRTID" => "network_layer_id"
          "ProcessID" => "process_id"
          "Protocol" => "network_protocol"
          "RemoteMachineID" => "dst_host_name_id"
          "RemoteUserID" => "dst_user_id"
          "SourcePort" => "src_port"
        }
      }
    }
    if [event_id] in [ 5376, 5377 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5376.md
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5377.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
        }
        add_field => { "etl_pipeline" => "winevent_security-5376_5377-ossem" }
      }
    }
    if [event_id] == 5378 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5378.md
      mutate {
        rename => {
          "Package" => "logon_security_package_name"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetServer" => "target_server_name"
          "UserUPN" => "user_identity"
          "CredType" => "user_cred_type"
        }
        add_field => { "etl_pipeline" => "winevent_security-5378-ossem" }
      }
    }
    if [event_id] == 5379 {
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "ReadOperation" => "object_operation_type"
          "ClientProcessId" => "process_id"
          "TargetName" => "credentials_read"
          "Type" => "credentials_read_type"
          "CountOfCredentialsReturned" => "credentials_read_returned_count"
          "ReturnCode" => "credentials_read_returned_code"
          "ProcessCreationTime" => "process_creation_time"
        }
      }
    }
    if [event_id] == 5447 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5447.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "AccessList" => "object_access_list"
          "AccessMask" => "object_access_mask"
          "AccessReason" => "user_access_reason"
          "IpPort" => "src_port"
          "ObjectType" => "object_type"
          "RelativeTargetName" => "share_relative_target_name"
          "ShareLocalPath" => "share_local_path"
          "ShareName" => "share_name"
          "Action" => "filtering_action"
          "CalloutKey" => "filtering_callout_key"
          "CalloutName" => "filtering_callout_name"
          "ChangeType" => "filtering_change_type"
          "Conditions" => "filtering_conditions"
          "FilterId" => "filtering_id"
          "FilterKey" => "filtering_key"
          "FilterName" => "filtering_name"
          "FilterType" => "filtering_type"
          "LayerId" => "filtering_layer_id"
          "LayerKey" => "filtering_layer_key"
          "LayerName" => "filtering_layer_name"
          "ProviderKey" => "filtering_provider_key"
          "ProviderName" => "filtering_provider_name"
          "UserName" => "user_name"
          "UserSid" => "user_sid"
          "Weight" => "filtering_weight"
        }
      }
    }
    if [event_id] == 6144 {
      # https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-6144
      mutate {
        rename => {
          "ErrorCode" => "error_code"
          "GPOList" => "gpo_list"
        }
      }
    }
    if [event_id] == 6416 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-6416.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "ClassId" => "device_class_id"
          "ClassName" => "device_class_name"
          "CompatibleIds" => "device_compatible_ids"
          "DeviceDescription" => "device_description"
          "DeviceId" => "device_id"
          "LocationInformation" => "device_location_information"
          "VendorIds" => "device_vendor_ids"
        }
      }
    }
    if [event_id] == 4626 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4626.md
      mutate {
        rename => {
          "DeviceClaims" => "logon_device_claims"
          "EventCountTotal" => "event_count_total"
          "EventIdx" => "event_sequence_id"
          "SubjectDomainName" => "user_reporter_domain"
          "SubjectLogonId" => "user_reporter_logon_id"
          "SubjectUserName" => "user_reporter_name"
          "SubjectUserSid" => "user_reporter_sid"
          "TargetDomainName" => "user_domain"
          "TargetLogonId" => "user_id"
          "TargetUserName" => "user_name"
          "TargetUserSid" => "user_sid"
          "UserClaims" => "logon_user_claims"
        }
        add_field => { "etl_pipeline" => "winevent_security-4626-ossem" }
      }
    }
    if [event_id] == 4664 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4664.md
      mutate {
        rename => {
          "FileName" => "file_name"
          "LinkName" => "file_link_name"
          "TransactionId" => "transaction_guid"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
        }
        add_field => { "etl_pipeline" => "winevent_security-4664-ossem" }
      }
    }
    if [event_id] == 5632 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5632.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "SSID" => "wireless_ssid"
          "Identity" => "user_identity"
          "PeerMac" => "host_peer_mac"
          "LocalMac" => "host_local_mac"
          "IntfGuid" => "host_interface_guid"
          "ReasonCode" => "event_reason_code"
          "ReasonText" => "event_reason_text"
          "ErrorCode" => "event_error_code"
          "EAPReasonCode" => "event_reason_code_eap"
          "EapRootCauseString" => "event_root_cause_string_eap"
          "EAPErrorCode" => "event_error_code_eap"
        }
        add_field => { "etl_pipeline" => "winevent_security-5632-ossem" }
        copy => {
          "host_local_mac" => "src_mac"
          "host_peer_mac" => "dst_mac"
        }
      }
    }
    else if [event_id] == 5633 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5633.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "InterfaceName" => "host_interface_name"
          "Identity" => "user_identity"
          "ReasonCode" => "event_reason_code"
          "ReasonText" => "event_reason_text"
          "ErrorCode" => "event_error_code"
        }
        add_field => { "etl_pipeline" => "winevent_security-5633-ossem" }
      }
    }
    else if [event_id] == 5051 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5051.md
      mutate {
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "FileName" => "file_name"
          "VirtualFileName" => "virtual_file_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-5051-ossem" }
      }
    }
    else if [event_id] == 4964 {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4964.md
      mutate {
        rename => {
          "LogonGuid" => "user_logon_guid"
          "SidList" => "target_user_sid_list"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
          "TargetDomainName" => "target_user_domain"
          "TargetLogonGuid" => "target_user_logon_guid"
          "TargetLogonId" => "target_user_logon_id"
          "TargetUserName" => "target_user_name"
          "TargetUserSid" => "target_user_sid"
        }
        add_field => { "etl_pipeline" => "winevent_security-4964-ossem" }
      }
    }
    else if [event_id] in [ 4774, 4775 ] {
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4774
      # https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4775
      mutate {
        rename => {
          "ClientUserName" => "user_name"
          "MappedName" => "target_user_name"
          "MappingBy" => "logon_authentication_package_name"
        }
        add_field => { "etl_pipeline" => "winevent_security-4774_4775-ossem" }
      }
    }
    else if [event_id] in [ 4882, 4883 ] {
      mutate {
        #TODO: leaving out RequestId and SecuritySettings until able to get good example logs
        rename => {
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
        }
        add_field => { "etl_pipeline" => "winevent_security-4882_4883-ossem" }
      }
    }
    else if [event_id] in [ 4692, 4693, 4694, 4695 ] {
      mutate {
        rename => {
          "RecoveryServer" => "target_host_name"
          "SubjectDomainName" => "user_domain"
          "SubjectLogonId" => "user_logon_id"
          "SubjectUserName" => "user_name"
          "SubjectUserSid" => "user_sid"
        }
        #TODO:keeping backwards compatibility
        copy => {
          "RecoveryKeyId" => "recovery_key_id"
          "MasterKeyId" => "master_key_id"
          "FailureReason" => "event_failure_reason"
          "RecoveryReason" => "recovery_key_reason"
        }
        add_field => { "etl_pipeline" => "winevent_security-audit_dpapi_activity-ossem" }
      }
    }
  }
}