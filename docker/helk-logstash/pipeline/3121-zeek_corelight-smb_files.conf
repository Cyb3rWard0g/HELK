# HELK Zeek and Corelight SMB_Files log
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {
  if [event_log_type] == "zeek" and [event_log_sub_type] == "smb_files" {

    mutate {
      rename => {
        "action" => "smb_action"
        "name" => "share_relative_target_name"
        "path" => "share_name"
        "prev_name" => "file_previous_name"
        "size" => "file_size"
        "times_accessed" => "file_accessed_time"
        "times_changed" => "file_changed_time"
        "times_created" => "file_creation_time"
        "times_modified" => "file_modified_time"
      }
      add_field => { "etl_pipeline" => "zeek-smb_files-main" }
    }

  }
}