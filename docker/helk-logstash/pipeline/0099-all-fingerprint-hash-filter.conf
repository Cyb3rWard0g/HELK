# HELK All filter conf file
# HELK build Stage: Alpha
# Author: Roberto Rodriguez (@Cyb3rWard0g), Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {

  if [message] {
    fingerprint {
      source => "message"
      target => "[@metadata][log_hash]"
      method => "MURMUR3"
      key => "Logstash"
      add_field => { "z_logstash_pipeline" => "fingerprint-0099-001" }
    }
  }

  # Scenario of no message field for winlogbeat, create custom one concating some values to gurantee a unique fingerprint
  #TONOTE: can use this value in z_logstash_pipeline to see if this event is hit
  #TODO:may want to add to end of the pipeline right before output
  else if [type] == "wineventlog" and [beat] {
    # Use this custom for this event
    mutate => { add_field => { "meta_log_tags" => "warning missing message field" } }
    fingerprint {
      concatenate_all_fields => true
      target => "[@metadata][log_hash]"
      method => "MURMUR3"
      key => "Logstash"
      add_field => { "z_logstash_pipeline" => "fingerprint-0099-002" }
    }
  }

}